### ptrack3_bio.f90

Source code for the harmful algal bloom model developed in [Xiong et al (2023)](https://aslopubs.onlinelibrary.wiley.com/doi/full/10.1002/lol2.10308). Search 'jx' to see the revisions compared to the original particle tracking code of [SCHISM](https://github.com/schism-dev/schism/tree/master/src/Utility/Particle_Tracking). Note: SCHISM's particle tracking is constantly updated by the developers.

The general idea for this particle-tracking model is to treat a numerical particle as a **virtual sensor** to record the water temperature, salinity, nutrient concentrations (mainly DIN here), turbidity, and light intensity (or other factors) that were experienced by each particle during its transport. The particle will also record a concentration to represent the changing algal biomass, which can grow or die based on the surrounding environments of each particle. Given an initial concentration C<sub>0</sub>, the changing algal biomass can be solved via dC/dt = gC, where g is the net growth rate. In this study, we tested the harmful algal species Margalefidinium polykrikoides because of the relatively well-developed equations that govern its bloom cycle ([Qin et al., 2021](https://www.sciencedirect.com/science/article/abs/pii/S1568988321000858) and [Hofmann et al., 2021](https://www.sciencedirect.com/science/article/abs/pii/S1568988321000949)). Another important part of this particle model is satellite data. We used the satellite to initiate <sub>0</sub> and evaluate the performance of the model. 


